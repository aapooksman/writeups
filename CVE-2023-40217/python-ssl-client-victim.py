import socket
import ssl

# Connect to a server with TCP
upstream_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)
upstream_socket.connect(('127.0.0.1', 12345))

# Wrap the TCP connection with TLS default context that checks the server certificate
ctx = ssl.create_default_context()
tls_socket = ctx.wrap_socket(upstream_socket, server_hostname="ssl-exploit-test")

# Receive data from the authenticated and secure TLS connection
print(tls_socket.recv(4096))

